var Ze=Object.defineProperty,Je=Object.defineProperties;var Ke=Object.getOwnPropertyDescriptors;var ae=Object.getOwnPropertySymbols;var Ce=Object.prototype.hasOwnProperty,Le=Object.prototype.propertyIsEnumerable;var de=(e,t,a)=>t in e?Ze(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,Y=(e,t)=>{for(var a in t||(t={}))Ce.call(t,a)&&de(e,a,t[a]);if(ae)for(var a of ae(t))Le.call(t,a)&&de(e,a,t[a]);return e},Se=(e,t)=>Je(e,Ke(t));var Pe=(e,t)=>{var a={};for(var o in e)Ce.call(e,o)&&t.indexOf(o)<0&&(a[o]=e[o]);if(e!=null&&ae)for(var o of ae(e))t.indexOf(o)<0&&Le.call(e,o)&&(a[o]=e[o]);return a};var M=(e,t,a)=>(de(e,typeof t!="symbol"?t+"":t,a),a);import{g as Ae,_ as R,d as V,r as L,o as P,h as j,a as f,i as E,j as oe,v as ie,p as J,e as K,F as we,k as ze,t as _e,n as W,l as Qe,m as et,q as tt,u as Te,s as at,x as ce,y as je,z as ue,c as ot,w as G,A as it,b as rt,B as nt,C as st,f as Ue}from"./plugin-vue_export-helper.c3c1043c.js";import{c as lt,F as dt,S as ct,R as ut,L as Ge,D as ft,I as gt,T as pt,a as fe,G as vt,b as ht}from"./Line.02cf2b9e.js";var mt={exports:{}};(function(e){var t=function(a){var o=Object.prototype,l=o.hasOwnProperty,s,c=typeof Symbol=="function"?Symbol:{},u=c.iterator||"@@iterator",d=c.asyncIterator||"@@asyncIterator",h=c.toStringTag||"@@toStringTag";function m(r,i,n){return Object.defineProperty(r,i,{value:n,enumerable:!0,configurable:!0,writable:!0}),r[i]}try{m({},"")}catch{m=function(i,n,p){return i[n]=p}}function $(r,i,n,p){var g=i&&i.prototype instanceof F?i:F,k=Object.create(g.prototype),D=new ne(p||[]);return k._invoke=He(r,n,D),k}a.wrap=$;function x(r,i,n){try{return{type:"normal",arg:r.call(i,n)}}catch(p){return{type:"throw",arg:p}}}var b="suspendedStart",z="suspendedYield",B="executing",y="completed",w={};function F(){}function _(){}function v(){}var C={};m(C,u,function(){return this});var S=Object.getPrototypeOf,T=S&&S(S(se([])));T&&T!==o&&l.call(T,u)&&(C=T);var I=v.prototype=F.prototype=Object.create(C);_.prototype=v,m(I,"constructor",v),m(v,"constructor",_),_.displayName=m(v,h,"GeneratorFunction");function ee(r){["next","throw","return"].forEach(function(i){m(r,i,function(n){return this._invoke(i,n)})})}a.isGeneratorFunction=function(r){var i=typeof r=="function"&&r.constructor;return i?i===_||(i.displayName||i.name)==="GeneratorFunction":!1},a.mark=function(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,v):(r.__proto__=v,m(r,h,"GeneratorFunction")),r.prototype=Object.create(I),r},a.awrap=function(r){return{__await:r}};function te(r,i){function n(k,D,O,U){var A=x(r[k],r,D);if(A.type==="throw")U(A.arg);else{var le=A.arg,H=le.value;return H&&typeof H=="object"&&l.call(H,"__await")?i.resolve(H.__await).then(function(q){n("next",q,O,U)},function(q){n("throw",q,O,U)}):i.resolve(H).then(function(q){le.value=q,O(le)},function(q){return n("throw",q,O,U)})}}var p;function g(k,D){function O(){return new i(function(U,A){n(k,D,U,A)})}return p=p?p.then(O,O):O()}this._invoke=g}ee(te.prototype),m(te.prototype,d,function(){return this}),a.AsyncIterator=te,a.async=function(r,i,n,p,g){g===void 0&&(g=Promise);var k=new te($(r,i,n,p),g);return a.isGeneratorFunction(i)?k:k.next().then(function(D){return D.done?D.value:k.next()})};function He(r,i,n){var p=b;return function(k,D){if(p===B)throw new Error("Generator is already running");if(p===y){if(k==="throw")throw D;return Ee()}for(n.method=k,n.arg=D;;){var O=n.delegate;if(O){var U=$e(O,n);if(U){if(U===w)continue;return U}}if(n.method==="next")n.sent=n._sent=n.arg;else if(n.method==="throw"){if(p===b)throw p=y,n.arg;n.dispatchException(n.arg)}else n.method==="return"&&n.abrupt("return",n.arg);p=B;var A=x(r,i,n);if(A.type==="normal"){if(p=n.done?y:z,A.arg===w)continue;return{value:A.arg,done:n.done}}else A.type==="throw"&&(p=y,n.method="throw",n.arg=A.arg)}}}function $e(r,i){var n=r.iterator[i.method];if(n===s){if(i.delegate=null,i.method==="throw"){if(r.iterator.return&&(i.method="return",i.arg=s,$e(r,i),i.method==="throw"))return w;i.method="throw",i.arg=new TypeError("The iterator does not provide a 'throw' method")}return w}var p=x(n,r.iterator,i.arg);if(p.type==="throw")return i.method="throw",i.arg=p.arg,i.delegate=null,w;var g=p.arg;if(!g)return i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,w;if(g.done)i[r.resultName]=g.value,i.next=r.nextLoc,i.method!=="return"&&(i.method="next",i.arg=s);else return g;return i.delegate=null,w}ee(I),m(I,h,"Generator"),m(I,u,function(){return this}),m(I,"toString",function(){return"[object Generator]"});function Xe(r){var i={tryLoc:r[0]};1 in r&&(i.catchLoc=r[1]),2 in r&&(i.finallyLoc=r[2],i.afterLoc=r[3]),this.tryEntries.push(i)}function re(r){var i=r.completion||{};i.type="normal",delete i.arg,r.completion=i}function ne(r){this.tryEntries=[{tryLoc:"root"}],r.forEach(Xe,this),this.reset(!0)}a.keys=function(r){var i=[];for(var n in r)i.push(n);return i.reverse(),function p(){for(;i.length;){var g=i.pop();if(g in r)return p.value=g,p.done=!1,p}return p.done=!0,p}};function se(r){if(r){var i=r[u];if(i)return i.call(r);if(typeof r.next=="function")return r;if(!isNaN(r.length)){var n=-1,p=function g(){for(;++n<r.length;)if(l.call(r,n))return g.value=r[n],g.done=!1,g;return g.value=s,g.done=!0,g};return p.next=p}}return{next:Ee}}a.values=se;function Ee(){return{value:s,done:!0}}return ne.prototype={constructor:ne,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(re),!r)for(var i in this)i.charAt(0)==="t"&&l.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=s)},stop:function(){this.done=!0;var r=this.tryEntries[0],i=r.completion;if(i.type==="throw")throw i.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var i=this;function n(U,A){return k.type="throw",k.arg=r,i.next=U,A&&(i.method="next",i.arg=s),!!A}for(var p=this.tryEntries.length-1;p>=0;--p){var g=this.tryEntries[p],k=g.completion;if(g.tryLoc==="root")return n("end");if(g.tryLoc<=this.prev){var D=l.call(g,"catchLoc"),O=l.call(g,"finallyLoc");if(D&&O){if(this.prev<g.catchLoc)return n(g.catchLoc,!0);if(this.prev<g.finallyLoc)return n(g.finallyLoc)}else if(D){if(this.prev<g.catchLoc)return n(g.catchLoc,!0)}else if(O){if(this.prev<g.finallyLoc)return n(g.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(r,i){for(var n=this.tryEntries.length-1;n>=0;--n){var p=this.tryEntries[n];if(p.tryLoc<=this.prev&&l.call(p,"finallyLoc")&&this.prev<p.finallyLoc){var g=p;break}}g&&(r==="break"||r==="continue")&&g.tryLoc<=i&&i<=g.finallyLoc&&(g=null);var k=g?g.completion:{};return k.type=r,k.arg=i,g?(this.method="next",this.next=g.finallyLoc,w):this.complete(k)},complete:function(r,i){if(r.type==="throw")throw r.arg;return r.type==="break"||r.type==="continue"?this.next=r.arg:r.type==="return"?(this.rval=this.arg=r.arg,this.method="return",this.next="end"):r.type==="normal"&&i&&(this.next=i),w},finish:function(r){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.finallyLoc===r)return this.complete(n.completion,n.afterLoc),re(n),w}},catch:function(r){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc===r){var p=n.completion;if(p.type==="throw"){var g=p.arg;re(n)}return g}}throw new Error("illegal catch attempt")},delegateYield:function(r,i,n){return this.delegate={iterator:se(r),resultName:i,nextLoc:n},this.method==="next"&&(this.arg=s),w}},a}(e.exports);try{regeneratorRuntime=t}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}})(mt);var bt={defaultArgs:["./ffmpeg","-nostdin","-y"],baseOptions:{log:!1,logger:()=>{},progress:()=>{},corePath:""}};let xe=!1,Re=()=>{};const yt=e=>{xe=e},wt=e=>{Re=e},_t=(e,t)=>{Re({type:e,message:t}),xe&&console.log(`[${e}] ${t}`)};var Me={logging:xe,setLogging:yt,setCustomLogger:wt,log:_t};let X=0,ge=0;const Be=e=>{const[t,a,o]=e.split(":");return parseFloat(t)*60*60+parseFloat(a)*60+parseFloat(o)};var xt=(e,t)=>{if(typeof e=="string")if(e.startsWith("  Duration")){const a=e.split(", ")[0].split(": ")[1],o=Be(a);t({duration:o,ratio:ge}),(X===0||X>o)&&(X=o)}else if(e.startsWith("frame")||e.startsWith("size")){const a=e.split("time=")[1].split(" ")[0],o=Be(a);ge=o/X,t({ratio:ge,time:o})}else e.startsWith("video:")&&(t({ratio:1}),X=0)},Ft=(e,t)=>{const a=e._malloc(t.length*Uint32Array.BYTES_PER_ELEMENT);return t.forEach((o,l)=>{const s=e._malloc(o.length+1);e.writeAsciiToMemory(o,s),e.setValue(a+Uint32Array.BYTES_PER_ELEMENT*l,s,"i32")}),[t.length,a]},Fe={exports:{}};(function(e,t){(function(a,o){e.exports=o()})(lt,function(){function a(){var o=arguments.length;if(o===0)throw new Error("resolveUrl requires at least one argument; got none.");var l=document.createElement("base");if(l.href=arguments[0],o===1)return l.href;var s=document.getElementsByTagName("head")[0];s.insertBefore(l,s.firstChild);for(var c=document.createElement("a"),u,d=1;d<o;d++)c.href=arguments[d],u=c.href,l.href=u;return s.removeChild(l),u}return a})})(Fe);const kt="@ffmpeg/ffmpeg",$t="0.10.1",Et="FFmpeg WebAssembly version",Ct="src/index.js",Lt="src/index.d.ts",St={example:"examples"},Pt={start:"node scripts/server.js",build:"rimraf dist && webpack --config scripts/webpack.config.prod.js",prepublishOnly:"npm run build",lint:"eslint src",wait:"rimraf dist && wait-on http://localhost:3000/dist/ffmpeg.dev.js",test:"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:ffmpeg test:node:all","test:node":"node --experimental-wasm-threads --experimental-wasm-bulk-memory node_modules/.bin/_mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser":"mocha-headless-chrome -a allow-file-access-from-files -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:ffmpeg":"npm run test:browser -- -f ./tests/ffmpeg.test.html"},jt={"./src/node/index.js":"./src/browser/index.js"},Bt={type:"git",url:"git+https://github.com/ffmpegwasm/ffmpeg.wasm.git"},It=["ffmpeg","WebAssembly","video"],Dt="Jerome Wu <jeromewus@gmail.com>",Ot="MIT",At={url:"https://github.com/ffmpegwasm/ffmpeg.wasm/issues"},zt={node:">=12.16.1"},Tt="https://github.com/ffmpegwasm/ffmpeg.wasm#readme",Ut={"is-url":"^1.2.4","node-fetch":"^2.6.1","regenerator-runtime":"^0.13.7","resolve-url":"^0.2.1"},Gt={"@babel/core":"^7.12.3","@babel/preset-env":"^7.12.1","@ffmpeg/core":"^0.10.0","@types/emscripten":"^1.39.4","babel-loader":"^8.1.0",chai:"^4.2.0",cors:"^2.8.5",eslint:"^7.12.1","eslint-config-airbnb-base":"^14.1.0","eslint-plugin-import":"^2.22.1",express:"^4.17.1",mocha:"^8.2.1","mocha-headless-chrome":"^2.0.3","npm-run-all":"^4.1.5","wait-on":"^5.3.0",webpack:"^5.3.2","webpack-cli":"^4.1.0","webpack-dev-middleware":"^4.0.0"};var Ve={name:kt,version:$t,description:Et,main:Ct,types:Lt,directories:St,scripts:Pt,browser:jt,repository:Bt,keywords:It,author:Dt,license:Ot,bugs:At,engines:zt,homepage:Tt,dependencies:Ut,devDependencies:Gt};const{devDependencies:Rt}=Ve;var Mt={corePath:`https://unpkg.com/@ffmpeg/core@${Rt["@ffmpeg/core"].substring(1)}/dist/ffmpeg-core.js`};const Vt=Fe.exports,{log:Z}=Me,pe=async(e,t)=>{Z("info",`fetch ${e}`);const a=await(await fetch(e)).arrayBuffer();Z("info",`${e} file size = ${a.byteLength} bytes`);const o=new Blob([a],{type:t}),l=URL.createObjectURL(o);return Z("info",`${e} blob URL = ${l}`),l};var qt=async({corePath:e})=>{if(typeof e!="string")throw Error("corePath should be a string!");const t=Vt(e),a=await pe(t,"application/javascript"),o=await pe(t.replace("ffmpeg-core.js","ffmpeg-core.wasm"),"application/wasm"),l=await pe(t.replace("ffmpeg-core.js","ffmpeg-core.worker.js"),"application/javascript");return typeof createFFmpegCore=="undefined"?new Promise(s=>{const c=document.createElement("script"),u=()=>{c.removeEventListener("load",u),Z("info","ffmpeg-core.js script loaded"),s({createFFmpegCore,corePath:a,wasmPath:o,workerPath:l})};c.src=a,c.type="text/javascript",c.addEventListener("load",u),document.getElementsByTagName("head")[0].appendChild(c)}):(Z("info","ffmpeg-core.js script is loaded already"),Promise.resolve({createFFmpegCore,corePath:a,wasmPath:o,workerPath:l}))};const Nt=Fe.exports,Yt=e=>new Promise((t,a)=>{const o=new FileReader;o.onload=()=>{t(o.result)},o.onerror=({target:{error:{code:l}}})=>{a(Error(`File could not be read! Code=${l}`))},o.readAsArrayBuffer(e)});var Wt=async e=>{let t=e;return typeof e=="undefined"?new Uint8Array:(typeof e=="string"?/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(e)?t=atob(e.split(",")[1]).split("").map(a=>a.charCodeAt(0)):t=await(await fetch(Nt(e))).arrayBuffer():(e instanceof File||e instanceof Blob)&&(t=await Yt(e)),new Uint8Array(t))};const Ht=Mt,Xt=qt,Zt=Wt;var qe={defaultOptions:Ht,getCreateFFmpegCore:Xt,fetchFile:Zt};const{defaultArgs:Jt,baseOptions:Kt}=bt,{setLogging:Ie,setCustomLogger:De,log:N}=Me,Qt=xt,ea=Ft,{defaultOptions:ta,getCreateFFmpegCore:aa}=qe,{version:oa}=Ve,ve=Error("ffmpeg.wasm is not ready, make sure you have completed load().");var ia=(e={})=>{const _=Y(Y(Y({},Kt),ta),e),{log:t,logger:a,progress:o}=_,l=Pe(_,["log","logger","progress"]);let s=null,c=null,u=null,d=!1,h=o;const m=v=>{v==="FFMPEG_END"&&u!==null&&(u(),u=null,d=!1)},$=({type:v,message:C})=>{N(v,C),Qt(C,h),m(C)},x=async()=>{if(N("info","load ffmpeg-core"),s===null){N("info","loading ffmpeg-core");const{createFFmpegCore:v,corePath:C,workerPath:S,wasmPath:T}=await aa(l);s=await v({mainScriptUrlOrBlob:C,printErr:I=>$({type:"fferr",message:I}),print:I=>$({type:"ffout",message:I}),locateFile:(I,ee)=>{if(typeof window!="undefined"){if(typeof T!="undefined"&&I.endsWith("ffmpeg-core.wasm"))return T;if(typeof S!="undefined"&&I.endsWith("ffmpeg-core.worker.js"))return S}return ee+I}}),c=s.cwrap("proxy_main","number",["number","number"]),N("info","ffmpeg-core loaded")}else throw Error("ffmpeg.wasm was loaded, you should not load it again, use ffmpeg.isLoaded() to check next time.")},b=()=>s!==null,z=(...v)=>{if(N("info",`run ffmpeg command: ${v.join(" ")}`),s===null)throw ve;if(d)throw Error("ffmpeg.wasm can only run one command at a time");return d=!0,new Promise(C=>{const S=[...Jt,...v].filter(T=>T.length!==0);u=C,c(...ea(s,S))})},B=(v,...C)=>{if(N("info",`run FS.${v} ${C.map(S=>typeof S=="string"?S:`<${S.length} bytes binary file>`).join(" ")}`),s===null)throw ve;{let S=null;try{S=s.FS[v](...C)}catch{throw Error(v==="readdir"?`ffmpeg.FS('readdir', '${C[0]}') error. Check if the path exists, ex: ffmpeg.FS('readdir', '/')`:v==="readFile"?`ffmpeg.FS('readFile', '${C[0]}') error. Check if the path exists`:"Oops, something went wrong in FS operation.")}return S}},y=()=>{if(s===null)throw ve;d=!1,s.exit(1),s=null,c=null,u=null},w=v=>{h=v},F=v=>{De(v)};return Ie(t),De(a),N("info",`use ffmpeg.wasm v${oa}`),{setProgress:w,setLogger:F,setLogging:Ie,load:x,isLoaded:b,run:z,exit:y,FS:B}};const ra=ia,{fetchFile:na}=qe;var he={createFFmpeg:ra,fetchFile:na};class sa{constructor(t){M(this,"options");this.options=t}async transforms(t){return Promise.all(t.map(async a=>await this.transform(a)))}async transform(t){const a=await this._loadImg(t.file),o=this._paintFrame({img:a,frame:t});return await this._canvasToBlob(o)}async _canvasToBlob(t){return new Promise(function(a,o){t.toBlob(function(l){l?a(l):o("\u6570\u636E\u5F02\u5E38")},"image/jpeg",1)})}_canvasToImage(t){var a=new Image;return a.src=t.toDataURL("image/png"),a}async _loadImg(t){return new Promise(function(a){const o=new Image;o.src=window.URL.createObjectURL(t),o.onload=function(){a(o)}})}_paintFrame(t){const{width:a,height:o,rule:l,background:s}=this.options,{img:c,frame:u}=t,d=document.createElement("canvas");d.width=a,d.height=o;const h=d.getContext("2d");if(!c||!h)throw new Error("\u6570\u636E\u5F02\u5E38");h.fillStyle=s,h.fillRect(0,0,d.width,d.height);const{canvasData:m,imgData:$}=function(){const{width:b,height:z}=c,{width:B,height:y}=d,w=Math.max(B/b,y/z,1),F=[0,0,b,z],_=[b*w,z*w],v=[-(B-b)/2,(y-_[1])/2,..._];return{imgData:F,canvasData:v}}();function x(b,z){const B=z==180?-1:1;b.translate((d.width-c.width*B)/2,0),b.scale(B*1,1);const[y,w,F,_]=$,[v,C,S,T]=m;b.drawImage(c,y,w,F,_,v,C,S,T),b.setTransform(1,0,0,1,0,0)}return x(h,u.rotateY),d}}class la{constructor(){M(this,"buffer");M(this,"frames");M(this,"options");M(this,"music");M(this,"ffmpeg");M(this,"ratio");this.buffer={gif:null,mp4:null},this.frames=[],this.options={width:800,height:1e3,repeat:0,delay:750,background:"#FFFFFF",rule:3,quality:.5},this.music={start:0},this.ffmpeg=he.createFFmpeg({log:!1}),this.ratio=0}setOpt(t){return this.options=Object.assign(this.options,t),this}setFrame(t){return this.frames=t,this}setMusic(t){return this.music=t,this}logProgress(t,a){if(t<0)return;const o=parseFloat((((a==="gif"?1:0)+t)/2).toFixed(4));o!=this.ratio&&(this.ratio=o,console.log(`\u751F\u6210\u8FDB\u5EA6\uFF1A${this.ratio*100}%`,this.ratio))}async toPreView(){return this.buffer={gif:null,mp4:null},await this._mixinMusic(),this.buffer.mp4?URL.createObjectURL(new Blob([this.buffer.mp4],{type:"video/mp4"})):""}async toFile(t){const a=`${t}-${Ae()}.${t}`;let o="";switch(t){case"gif":o="image/gif";break;case"mp4":o="video/mp4";break}if(!this.buffer[t])return"";dt.exports.saveAs(new Blob([this.buffer[t]],{type:o}),a)}_toTime(t){const a=t%60;return`00:${((t-a)/60).toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`}async _mixinMusic(){if(this.frames.length==0)return;this.ffmpeg.isLoaded()||await this.ffmpeg.load();const t="out.mp4",a="out.gif",o="music.mp3",{delay:l,quality:s}=this.options,{file:c,start:u}=this.music,d=1e3/l,h=17+Math.round(s*10),m=l/1e3*this.frames.length,x=await new sa(this.options).transforms(this.frames),b=[];if(x.forEach(async(y,w)=>{this.ffmpeg.FS("writeFile",`${w}.jpg`,await he.fetchFile(y)),b.push(`${w}.jpg`)}),this.ffmpeg.setProgress(({ratio:y})=>this.logProgress(y,"mp4")),c){this.ffmpeg.FS("writeFile",o,await he.fetchFile(c));const y=this._toTime(u);await this.ffmpeg.run("-r",`${d}`,"-f","image2","-i","%d.jpg","-i",o,"-ss",y,"-t",`${m}`,"-crf",`${h}`,t)}else await this.ffmpeg.run("-r",`${d}`,"-f","image2","-i","%d.jpg","-crf",`${h}`,t);const z=this.ffmpeg.FS("readFile",t).buffer;this.ffmpeg.setProgress(({ratio:y})=>this.logProgress(y,"gif")),await this.ffmpeg.run("-i",t,a);const B=this.ffmpeg.FS("readFile",a).buffer;b.forEach(y=>this.ffmpeg.FS("unlink",y)),this.buffer={gif:B,mp4:z}}}const Q=e=>(J("data-v-747a75ea"),e=e(),K(),e),da={class:"form"},ca=Q(()=>f("span",null,"\u5BBD / \u9AD8\uFF1A",-1)),ua=Q(()=>f("span",null,"\u8D28\u91CF\uFF1A",-1)),fa=Q(()=>f("span",{for:"background"},"\u80CC\u666F\u8272\uFF1A",-1)),ga=Q(()=>f("span",{for:"delay"},"\u505C\u7559\u65F6\u95F4\uFF1A",-1)),pa=Q(()=>f("span",{for:"repeat"},"\u91CD\u590D\u6B21\u6570\uFF1A",-1)),va=V({__name:"gif-canvas",props:{value:null},emits:["update:value","change"],setup(e,{emit:t}){const a=e,o=L({width:a.value.width,height:a.value.height}),l=function(u){let d=a.value;u&&(d=Object.assign(d,u)),t("update:value",d),t("change")},s=function(u){l(u)},c=function(){l()};return(u,d)=>(P(),j("div",da,[f("div",null,[ca,E(ct,{value:o.value,onChange:s},null,8,["value"])]),f("div",null,[ua,f("div",null,[E(ut,{ref:"scaleRange",value:e.value.quality,"onUpdate:value":d[0]||(d[0]=h=>e.value.quality=h),onChange:c},null,8,["value"])])]),E(Ge),f("div",null,[fa,f("div",null,[oe(f("input",{type:"color",name:"background","onUpdate:modelValue":d[1]||(d[1]=h=>e.value.background=h),onChange:l},null,544),[[ie,e.value.background]])])]),f("div",null,[ga,f("div",null,[oe(f("input",{type:"number",name:"delay",min:"0",placeholder:"\u505C\u7559\u65F6\u95F4 \u6BEB\u79D2","onUpdate:modelValue":d[2]||(d[2]=h=>e.value.delay=h),onChange:l},null,544),[[ie,e.value.delay]])])]),f("div",null,[pa,f("div",null,[oe(f("input",{type:"number",name:"repeat",min:"-1",placeholder:"-1 never 0 ever or number","onUpdate:modelValue":d[3]||(d[3]=h=>e.value.repeat=h),onChange:l},null,544),[[ie,e.value.repeat]])])])]))}});var ha=R(va,[["__scopeId","data-v-747a75ea"]]);const ma=e=>(J("data-v-7d1fe6f4"),e=e(),K(),e),ba={class:"form"},ya={class:"music-select"},wa=["onClick"],_a=ma(()=>f("span",null,"\u8D77\u59CB\u65F6\u95F4\uFF1A",-1)),xa=V({__name:"gif-music",props:{value:null},emits:["update:value","change"],setup(e,{emit:t}){const a=e,o=L([]),l=function(c){let u=a.value;c&&(u=Object.assign(u,c)),t("update:value",u),t("change")},s=function(c){c.selected||(o.value=o.value.map(u=>(u.selected=c.id==u.id,u)),l({file:c.file}))};return(c,u)=>(P(),j("div",ba,[E(ft,{value:o.value,"onUpdate:value":u[0]||(u[0]=d=>o.value=d),max_size:1024*50,file_type:["audio/mpeg"]},null,8,["value"]),f("div",ya,[f("ul",null,[(P(!0),j(we,null,ze(o.value,d=>(P(),j("li",{class:"line",onClick:h=>s(d)},[f("span",null,_e(d.file.name),1),f("span",null,[f("i",{class:W(["css-icon",d.selected?"select":""])},null,2)])],8,wa))),256))])]),E(Ge),f("div",null,[_a,f("div",null,[oe(f("input",{type:"number",name:"start","onUpdate:modelValue":u[1]||(u[1]=d=>e.value.start=d),onChange:l},null,544),[[ie,e.value.start]])])])]))}});var Fa=R(xa,[["__scopeId","data-v-7d1fe6f4"]]);const ka={class:"list"},$a={class:"img"},Ea=["src"],Ca={class:"tools icon-group"},La=V({__name:"FrameEditor",props:{list:null},setup(e,{expose:t}){const a=e,o=L([]);Qe(a,function(){o.value=a.list.map(c=>{const u=o.value.find(d=>c.id==d.id);return u||Object.assign({rotateX:0,rotateY:0,rotateZ:0},c)})}),t({getFrames:function(){return o.value.map(c=>Y({},c))}});const s=function(c){o.value[c].rotateY=o.value[c].rotateY==0?180:0};return(c,u)=>(P(),j("div",ka,[f("ul",null,[(P(!0),j(we,null,ze(o.value,(d,h)=>(P(),j("li",{key:d.id},[f("div",$a,[f("img",{src:d.src,alt:"",style:et({transform:`rotateX(${d.rotateX}deg) rotateY(${d.rotateY}deg) rotateZ(${d.rotateZ}deg)`})},null,12,Ea),f("span",null,"\u7B2C "+_e(h+1)+" \u5E27",1)]),f("div",Ca,[E(gt,{type:"flip-x",onClick:m=>s(h)},null,8,["onClick"])])]))),128))])]))}});var Sa=R(La,[["__scopeId","data-v-6e9ce642"]]);const Pa={},ja={class:"dialog-loading global-loading"},Ba=tt('<div class="global-loading-dot" data-v-ed30dbd0></div><div class="global-loading-dot" data-v-ed30dbd0></div><div class="global-loading-dot" data-v-ed30dbd0></div><div class="global-loading-dot" data-v-ed30dbd0></div><div class="global-loading-dot" data-v-ed30dbd0></div><div class="global-loading-dot" data-v-ed30dbd0></div><div class="global-loading-dot" data-v-ed30dbd0></div><div class="global-loading-dot" data-v-ed30dbd0></div><div class="global-loading-dot" data-v-ed30dbd0></div><div class="global-loading-dot" data-v-ed30dbd0></div><div class="global-loading-dot" data-v-ed30dbd0></div><div class="global-loading-dot" data-v-ed30dbd0></div>',12),Ia=[Ba];function Da(e,t){return P(),j("div",ja,Ia)}var Oa=R(Pa,[["render",Da],["__scopeId","data-v-ed30dbd0"]]);const Aa=V({__name:"Overlay",props:{show:{type:Boolean,default:!1}},setup(e){return(t,a)=>(P(),j("div",{class:W(["overlay",e.show?"overlay-show":""])},null,2))}});var za=R(Aa,[["__scopeId","data-v-07cab184"]]);const Ta=e=>(J("data-v-19456f35"),e=e(),K(),e),Ua=["id"],Ga={class:"dialog-center-box"},Ra=Ta(()=>f("span",{class:"css-icon delete bold"},null,-1)),Ma=[Ra],Va={key:1,class:"dialog-header"},qa={class:"dialog-content"},Na={key:2,class:"dialog-footer"},Ya=V({__name:"Dialog",props:{size:{type:String,default:"max-content"},needClose:{type:Boolean,default:!0},show:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},emits:["update:show","update:loading"],setup(e,{emit:t}){const a=L(Te()),o=at(),l=function(){t("update:show",!1),t("update:loading",!1)};return(s,c)=>(P(),j("div",{id:a.value,class:W(["dialog","dialog-"+e.size,e.show?"open":""])},[E(za,{show:e.show,onClick:l},null,8,["show"]),E(Oa,{class:W(["dialog-loading",e.loading?"show":""])},null,8,["class"]),f("div",Ga,[e.needClose?(P(),j("div",{key:0,class:"dialog-close",onClick:l},Ma)):ce("",!0),je(o).header?(P(),j("div",Va,[ue(s.$slots,"header",{},void 0,!0)])):ce("",!0),f("div",qa,[ue(s.$slots,"content",{},void 0,!0)]),je(o).footer?(P(),j("div",Na,[ue(s.$slots,"footer",{},void 0,!0)])):ce("",!0)])],10,Ua))}});var Wa=R(Ya,[["__scopeId","data-v-19456f35"]]);const Ha=["src","width"],Xa={class:"btn-group center"},Za=V({__name:"PreViewDialog",props:{ratio:{type:Number,default:1}},emits:["footer-click"],setup(e,{expose:t,emit:a}){const o=L(""),l=window.screen.height*.6,s=L(!1),c=L(!1),u=function($=!1){s.value=!0,c.value=$};t({display:function($){o.value=$,u()},load:function(){u(!0)},open:u});const m=function($){a("footer-click",$)};return($,x)=>(P(),ot(Wa,{show:s.value,"onUpdate:show":x[2]||(x[2]=b=>s.value=b),loading:c.value,"onUpdate:loading":x[3]||(x[3]=b=>c.value=b)},{content:G(()=>[f("video",{src:o.value,width:l*e.ratio,height:l,class:"preview",controls:"",autoplay:""},null,8,Ha)]),footer:G(()=>[f("div",Xa,[f("button",{class:"button large C",onClick:x[0]||(x[0]=b=>m("gif"))},"\u4E0B\u8F7DGIF"),f("button",{class:"button large C",onClick:x[1]||(x[1]=b=>m("mp4"))},"\u4E0B\u8F7DMP4")])]),_:1},8,["show","loading"]))}});var Ja=R(Za,[["__scopeId","data-v-44d1a161"]]);const Ne=e=>(J("data-v-4db207e5"),e=e(),K(),e),Ka=Ne(()=>f("span",null,"Pic GIF",-1)),Qa=Ne(()=>f("button",{class:"button C"},[f("a",{href:"./collage.html"},"Pic Collage")],-1)),eo={class:"left"},to={class:"right"},ao=V({__name:"index",setup(e){const t=L([]),a=L("library"),o=L(""),l=L(),s=L(),c=L(),u=L({width:800,height:1e3,repeat:0,delay:750,background:"#FFFFFF",rule:3,quality:.5}),d=L({start:0}),h=L([]),m=new la,$=it("_message"),x=()=>{nt(()=>{o.value="",l.value.clearSelect(),$({type:"success",value:"\u6E05\u7406\u6210\u529F..."})})},b=F=>{t.value.push({value:F,timestamp:Ae()})},z=async function(){var F=c.value.getFrames();if(!F||F.length==0){$({type:"warning",value:"\u8BF7\u4ECE\u56FE\u5E93\u4E2D\u9009\u62E9\u3002"});return}$({value:"\u6B63\u5728\u52A0\u8F7D\u63D2\u4EF6\uFF0C\u8BF7\u7B49\u5F85..."}),s.value.load();var _=await m.setOpt(u.value).setMusic(d.value).setFrame(F).toPreView().catch(v=>console.log(v));s.value.display(_)},B=function(F){var _=c.value.getFrames();!_||_.length==0||m.toFile(F).catch(v=>console.log(v))},y=L([]),w=function(F){y.value=F};return(F,_)=>(P(),j(we,null,[E(rt,{needLog:!0},{header:G(()=>[Ka]),menu:G(()=>[Qa]),main:G(()=>[f("div",eo,[E(pt,{selected:a.value,"onUpdate:selected":_[1]||(_[1]=v=>a.value=v)},{default:G(()=>[E(fe,{key:"library",title:"\u56FE\u5E93"},{default:G(()=>[E(vt,{ref_key:"galleryLoader",ref:l,value:h.value,"onUpdate:value":_[0]||(_[0]=v=>h.value=v),onLog:b,need_decision:!0,onDecision:w},null,8,["value"])]),_:1}),E(fe,{key:"music",title:"\u97F3\u4E50\u5E93"},{default:G(()=>[E(Fa,{value:d.value},null,8,["value"])]),_:1}),E(fe,{key:"setting",title:"\u8BBE\u7F6E"},{default:G(()=>[E(ha,{value:u.value},null,8,["value"])]),_:1})]),_:1},8,["selected"]),f("div",{class:"btn-group center"},[f("button",{class:"button large",onClick:z},"\u751F\u6210\u9884\u89C8")])]),f("div",to,[f("div",{class:"btn-group right"},[f("button",{class:"button A",onClick:x},"\u6E05\u7406\u5E27")]),E(Sa,{ref_key:"frameEditor",ref:c,list:y.value},null,8,["list"])])]),footer:G(()=>[E(ht,{logs:t.value},null,8,["logs"])]),_:1}),E(Ja,{ref_key:"previewDialog",ref:s,ratio:u.value.width/u.value.height,onFooterClick:B},null,8,["ratio"])],64))}});var oo=R(ao,[["__scopeId","data-v-4db207e5"]]);const io=e=>(J("data-v-0026c91e"),e=e(),K(),e),ro=io(()=>f("i",{class:"css-icon delete"},null,-1)),no=[ro],so=V({__name:"Message",props:{type:{type:String,default:"info"},value:{type:String,default:""},timeout:{type:Number,default:3e3},remove:Function},setup(e){const t=e;let a;const o=L(!1);st(()=>{o.value=!0;const s=300;a=setTimeout(function(){o.value=!1,setTimeout(function(){typeof t.remove=="function"&&t.remove()},s)},t.timeout-s)});const l=()=>{typeof t.remove=="function"&&t.remove(),a&&clearTimeout(a)};return(s,c)=>(P(),j("div",{class:W(["global-message-box",o.value?"open":""])},[f("div",{class:W(["global-message-value",e.type])},_e(e.value),3),f("span",{class:"global-message-btn",onClick:l},no)],2))}});var Ye=R(so,[["__scopeId","data-v-0026c91e"]]);let Oe;const me={margin:40,zIndex:1e4};let We=0,ke=me.margin,be=[];const lo=(e,t)=>{be.push(e),e.setAttribute("no",t.toString()),e.classList.add("global_message"),e.style.position="fixed",e.style.right=`${me.margin}px`,e.style.zIndex=me.zIndex.toString(),e.style.top=`${ke}px`},co=(e,t,a)=>{be.forEach((o,l)=>{l>0&&(o.style.top=`${o.offsetTop-be[l-1].offsetHeight}px`)}),ke-=t.offsetHeight,We--,a&&a()},uo=(e,t)=>{const a=e.getAttribute("no");if(!a)return;const o=Ue(Ye,Se(Y({},t),{modelValue:!0,remove(){co(parseInt(a),e,()=>{o.unmount(),document.body.removeChild(e)})}}));return o.mount(e)};function ye(e={}){e.id=`message_${Te()}`;const t=document.createElement("div");return lo(t,We++),document.body.appendChild(t),Oe=uo(t,e),ke+=t.offsetHeight,Oe}ye.install=e=>{e.component("message",Ye),e.provide("_message",ye)};const fo=Ue(oo);fo.use(ye).mount("#app");
