import{_ as N,d as V,r as $,bv as z,o as S,h as T,a as v,u as W,n as J,p as q,e as G,F as Q,k as Y,ai as P,t as H}from"./BaseLayout.613ccd08.js";const K=n=>(q("data-v-58ded132"),n=n(),G(),n),Z={class:"drop-file"},ee=["id","accept","multiple"],te=K(()=>v("button",{class:"button large"},"\u70B9\u51FB\u4E0A\u4F20",-1)),ae=K(()=>v("span",null,"\u6216\u5C06\u6587\u4EF6\u62D6\u62FD\u5230\u6B64\u533A\u57DF",-1)),ne=[te,ae],oe=V({__name:"DropFile",props:{max_size:{type:Number,default:1024*10},value:{type:Array,default:[]},multiple:{type:Boolean,default:!0},file_type:{type:Array,default:["image/jpeg","image/png","image/webp"]}},emits:["update:value","change","log"],setup(n,{expose:w,emit:u}){const i=n,h=$(!1),p=$(i.value),c=z(),_=function(t){console.log(t),u("log",t)},y=async function(t){const d=t.target.files;await b(d)},e=function(t){t.stopPropagation(),t.preventDefault()},a=async function(t){e(t);let d=t.dataTransfer.files;await b(d),h.value=!1},f=function(t){e(t),h.value=!0},o=function(t){e(t),h.value=!1},s=function(){document.querySelector("#drop-file-core_"+c).click()},k=t=>new Promise((d,g)=>{let r=new FileReader;r.onload=()=>{if(!(event!=null&&event.target))return;const l=event==null?void 0:event.target;l.result&&typeof l.result=="string"?d(l.result):g("img empty")},r.readAsDataURL(t)}),j=async t=>new Promise((d,g)=>{const r=new Image;r.src=t,r.onload=function(){const l=document.createElement("canvas"),I=l.getContext("2d");if(!I){g("autoCropImg error.");return}l.width=r.width,l.height=r.height,I.drawImage(r,0,0);const O=I.getImageData(0,0,l.width,l.height).data;let E=l.width,C=0,x=l.height,R=0;for(let A=0;A<l.width;A++)for(let L=0;L<l.height;L++){const M=(A+l.width*L)*4;(O[M]==255||O[M+1]==255||O[M+2]==255||O[M+3]==255)&&(R=Math.max(L,R),C=Math.max(A,C),x=Math.min(L,x),E=Math.min(A,E))}E++,C++,x++,R++;const m=document.createElement("canvas");m.width=C-E,m.height=R-x;const U=m.getContext("2d");if(!U){g("autoCropImg error.");return}U.drawImage(r,E,x,m.width,m.height,0,0,m.width,m.height),d(m.toDataURL())}}),F=async t=>{if(["image/jpeg","image/png","image/webp"].includes(t.type)){const d=await k(t);return j(d)}return window.URL.createObjectURL(t)},b=async t=>{if(!t)return;let d=t.length;i.multiple||(p.value=[],d=1);for(let g=0;g<d;g++){const r=t[g];if(!i.file_type.includes("*")){if(!i.file_type.includes(r.type)){_(`\u5141\u8BB8\u4E0A\u4F20\u7684\u6587\u4EF6\u683C\u5F0F\u4E3A\uFF1A${i.file_type}\uFF0C\u8BE5\u6587\u4EF6\u7684\u683C\u5F0F\u662F${r.type}`);return}}if(r.size>i.max_size*1e3){_(`\u5141\u8BB8\u4E0A\u4F20\u7684\u6700\u5927\u6587\u4EF6\u5927\u5C0F\u4E3A\uFF1A${i.max_size/1e3}MB`);return}p.value.push({id:z(),src:await F(r),file:r,selected:!1}),_(`${r.name} \u5DF2\u4E0A\u4F20\uFF0C\u5171${r.size/1e3}KB\u3002`)}u("change",[...p.value]),u("update:value",[...p.value])};return w({setVal:function(){p.value=arguments[0],u("change",[...p.value]),u("update:value",[...p.value])}}),(t,d)=>(S(),T("div",Z,[v("input",{type:"file",id:`drop-file-core_${W(c)}`,accept:n.file_type.join(","),class:"drop-file-core",multiple:n.multiple,onChange:y},null,40,ee),v("div",{class:J(["drop-file-box",[h.value?"drop-in":""]]),onDrop:a,onDragenter:f,onDragleave:o,onDragover:e,onClick:s},ne,34)]))}});var pe=N(oe,[["__scopeId","data-v-58ded132"]]),D=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function fe(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function ge(n){if(n.__esModule)return n;var w=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(n).forEach(function(u){var i=Object.getOwnPropertyDescriptor(n,u);Object.defineProperty(w,u,i.get?i:{enumerable:!0,get:function(){return n[u]}})}),w}var ie={exports:{}};(function(n,w){(function(u,i){i()})(D,function(){function u(e,a){return typeof a=="undefined"?a={autoBom:!1}:typeof a!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\uFEFF",e],{type:e.type}):e}function i(e,a,f){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){y(o.response,a,f)},o.onerror=function(){console.error("could not download file")},o.send()}function h(e){var a=new XMLHttpRequest;a.open("HEAD",e,!1);try{a.send()}catch{}return 200<=a.status&&299>=a.status}function p(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(a)}}var c=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof D=="object"&&D.global===D?D:void 0,_=c.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),y=c.saveAs||(typeof window!="object"||window!==c?function(){}:"download"in HTMLAnchorElement.prototype&&!_?function(e,a,f){var o=c.URL||c.webkitURL,s=document.createElement("a");a=a||e.name||"download",s.download=a,s.rel="noopener",typeof e=="string"?(s.href=e,s.origin===location.origin?p(s):h(s.href)?i(e,a,f):p(s,s.target="_blank")):(s.href=o.createObjectURL(e),setTimeout(function(){o.revokeObjectURL(s.href)},4e4),setTimeout(function(){p(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,a,f){if(a=a||e.name||"download",typeof e!="string")navigator.msSaveOrOpenBlob(u(e,f),a);else if(h(e))i(e,a,f);else{var o=document.createElement("a");o.href=e,o.target="_blank",setTimeout(function(){p(o)})}}:function(e,a,f,o){if(o=o||open("","_blank"),o&&(o.document.title=o.document.body.innerText="downloading..."),typeof e=="string")return i(e,a,f);var s=e.type==="application/octet-stream",k=/constructor/i.test(c.HTMLElement)||c.safari,j=/CriOS\/[\d]+/.test(navigator.userAgent);if((j||s&&k||_)&&typeof FileReader!="undefined"){var F=new FileReader;F.onloadend=function(){var t=F.result;t=j?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=t:location=t,o=null},F.readAsDataURL(e)}else{var b=c.URL||c.webkitURL,B=b.createObjectURL(e);o?o.location=B:location.href=B,o=null,setTimeout(function(){b.revokeObjectURL(B)},4e4)}});c.saveAs=y.saveAs=y,n.exports=y})})(ie);const X=n=>(q("data-v-a2de274a"),n=n(),G(),n),re={id:"log"},se=X(()=>v("h3",{class:"title"},"\u65E5\u5FD7\uFF1A",-1)),le={class:"log-mes"},ue=X(()=>v("br",null,null,-1)),ce=V({__name:"Log",props:{logs:null},setup(n){return(w,u)=>(S(),T("div",re,[se,v("div",le,[v("ul",null,[(S(!0),T(Q,null,Y(n.logs,i=>(S(),T("li",{key:i.timestamp},[P(H(i.timestamp)+" ",1),ue,P(" "+H(i.value),1)]))),128))])])]))}});var me=N(ce,[["__scopeId","data-v-a2de274a"]]);export{pe as D,ie as F,me as L,fe as a,D as c,ge as g};
